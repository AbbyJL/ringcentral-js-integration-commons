{"version":3,"sources":["modules/Auth/getAuthReducer.js"],"names":["getLoginStatusReducer","getTokenReducer","getFreshLoginReducer","getProxyLoadedReducer","getProxyRetryCountReducer","getAuthReducer","types","state","type","loggedIn","refreshTokenValid","login","loggingIn","loginSuccess","refreshSuccess","cancelLogout","loginError","logoutSuccess","logoutError","notLoggedIn","refreshError","logout","loggingOut","beforeLogout","initSuccess","tabSync","token","ownerId","owner_id","endpointId","endpoint_id","accessToken","access_token","expireTime","expire_time","expiresIn","expires_in","proxyLoaded","proxyCleared","proxySetup","proxyRetry","status","loginStatus","freshLogin","proxyRetryCount"],"mappings":"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","file":"getAuthReducer.js","sourcesContent":["import { combineReducers } from 'redux';\nimport loginStatus from './loginStatus';\nimport getModuleStatusReducer from '../../lib/getModuleStatusReducer';\n\nexport function getLoginStatusReducer(types) {\n  return (state = null, { type, loggedIn, refreshTokenValid }) => {\n    switch (type) {\n      case types.login:\n        return loginStatus.loggingIn;\n\n      case types.loginSuccess:\n      case types.refreshSuccess:\n      case types.cancelLogout:\n        return loginStatus.loggedIn;\n\n      case types.loginError:\n      case types.logoutSuccess:\n      case types.logoutError:\n        return loginStatus.notLoggedIn;\n\n      case types.refreshError:\n        return refreshTokenValid ? state : loginStatus.notLoggedIn;\n\n      case types.logout:\n        return loginStatus.loggingOut;\n\n      case types.beforeLogout:\n        return loginStatus.beforeLogout;\n\n      case types.initSuccess:\n      case types.tabSync:\n        return loggedIn ? loginStatus.loggedIn : loginStatus.notLoggedIn;\n\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getTokenReducer(types) {\n  return (state = {}, { type, token, refreshTokenValid }) => {\n    switch (type) {\n      case types.loginSuccess:\n      case types.refreshSuccess:\n        return {\n          ownerId: token.owner_id,\n          endpointId: token.endpoint_id,\n          accessToken: token.access_token,\n          expireTime: token.expire_time,\n          expiresIn: token.expires_in,\n        };\n      case types.loginError:\n      case types.logoutSuccess:\n      case types.logoutError:\n        return {};\n\n      case types.refreshError:\n        if (refreshTokenValid) {\n          return state;\n        }\n        return {};\n      case types.initSuccess:\n      case types.tabSync:\n        if (token) {\n          return {\n            ownerId: token.owner_id,\n            endpointId: token.endpoint_id,\n            accessToken: token.access_token,\n            expireTime: token.expire_time,\n            expiresIn: token.expires_in,\n          };\n        }\n        return {};\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getFreshLoginReducer(types) {\n  return (state = null, { type, loggedIn }) => {\n    switch (type) {\n      case types.initSuccess:\n      case types.tabSync:\n        return loggedIn ? false : null;\n\n      case types.login:\n        return true;\n\n      case types.loginError:\n      case types.refreshError:\n      case types.logoutSuccess:\n      case types.logoutError:\n        return null;\n\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getProxyLoadedReducer(types) {\n  return (state = false, { type }) => {\n    switch (type) {\n      case types.proxyLoaded:\n        return true;\n      case types.proxyCleared:\n        return false;\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getProxyRetryCountReducer(types) {\n  return (state = 0, { type }) => {\n    switch (type) {\n      case types.proxySetup:\n      case types.proxyCleared:\n      case types.proxyLoaded:\n        return 0;\n      case types.proxyRetry:\n        return state + 1;\n      default:\n        return state;\n    }\n  };\n}\n\nexport default function getAuthReducer(types) {\n  return combineReducers({\n    status: getModuleStatusReducer(types),\n    loginStatus: getLoginStatusReducer(types),\n    freshLogin: getFreshLoginReducer(types),\n    token: getTokenReducer(types),\n    proxyLoaded: getProxyLoadedReducer(types),\n    proxyRetryCount: getProxyRetryCountReducer(types),\n  });\n}\n"]}