{"version":3,"sources":["modules/Conference/index.js"],"names":["DEFAULT_MASK","Conference","deps","dep","optional","client","regionSettings","storage","options","name","fetchFunction","account","extension","conferencing","get","actionTypes","_dialInNumberStorageKey","_additionalNumbersStorageKey","_storage","registerReducer","key","reducer","updateDialInNumber","updateAdditionalNumbers","allowJoinBeforeHost","_client","put","data","_store","dispatch","type","fetchSuccess","dialInNumber","additionalNumbers","_tabManager","active","getItem","phoneNumber"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAMA,eAAe,4FAArB;;AAEA;;;;IASqBC,U,WALpB,gBAAO;AACNC,QAAM,CACJ,QADI,EACM,SADN,EACiB,gBADjB,EACmC,EAAEC,KAAK,mBAAP,EAA4BC,UAAU,IAAtC,EADnC;AADA,CAAP,C;;;AAMC;;;;;;AAMA,4BAKG;AAAA;;AAAA,QAJDC,MAIC,QAJDA,MAIC;AAAA,QAHDC,cAGC,QAHDA,cAGC;AAAA,QAFDC,OAEC,QAFDA,OAEC;AAAA,QADEC,OACF;AAAA;;AAAA;AAECC,YAAM,YAFP;AAGCJ,oBAHD;AAICK;AAAA,+EAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBACPL,OAAOM,OAAP,GAAiBC,SAAjB,GAA6BC,YAA7B,GAA4CC,GAA5C,EADO;;AAAA;AAAA;AAAA,gCAEbd,YAFa;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAf;;AAAA;AAAA;AAAA;AAAA,SAJD;AAQCe,wCARD;AASCR;AATD,OAUIC,OAVJ;;AAYD,UAAKQ,uBAAL,GAA+B,wBAA/B;AACA,UAAKC,4BAAL,GAAoC,6BAApC;AACA,UAAKC,QAAL,CAAcC,eAAd,CAA8B;AAC5BC,WAAK,MAAKJ,uBADkB;AAE5BK,eAAS,mCAAoB,MAAKN,WAAL,CAAiBO,kBAArC,EAAyD,cAAzD;AAFmB,KAA9B;AAIA,UAAKJ,QAAL,CAAcC,eAAd,CAA8B;AAC5BC,WAAK,MAAKH,4BADkB;AAE5BI,eAAS,mCAAoB,MAAKN,WAAL,CAAiBQ,uBAArC,EAA8D,mBAA9D;AAFmB,KAA9B;AAlBC;AAsBF;;;;;+FAGgCC,mB;;;;;;;uBACZ,KAAKC,OAAL,CAAad,OAAb,GAAuBC,SAAvB,GAAmCC,YAAnC,GAChBa,GADgB,CACZ,EAAEF,wCAAF,EADY,C;;;AAAbG,oB;;AAEN,qBAAKC,MAAL,CAAYC,QAAZ,CAAqB,EAAEC,MAAM,KAAKf,WAAL,CAAiBgB,YAAzB,EAAuCJ,UAAvC,EAArB;;;;;;;;;;;;;;;;;;uCAIiBK,Y,EAAc;AAC/B,WAAKJ,MAAL,CAAYC,QAAZ,CAAqB,EAAEC,MAAM,KAAKf,WAAL,CAAiBO,kBAAzB,EAA6CU,0BAA7C,EAArB;AACD;;;4CAGuBC,iB,EAAmB;AACzC,WAAKL,MAAL,CAAYC,QAAZ,CAAqB,EAAEC,MAAM,KAAKf,WAAL,CAAiBQ,uBAAzB,EAAkDU,oCAAlD,EAArB;AACD;;;mCAUc;AACb,aAAO,CAAC,KAAKC,WAAN,IAAqB,KAAKA,WAAL,CAAiBC,MAA7C;AACD;;;wBAVuB;AACtB,aAAO,KAAKjB,QAAL,CAAckB,OAAd,CAAsB,KAAKnB,4BAA3B,KAA4D,EAAnE;AACD;;;wBAEkB;AACjB,aAAO,KAAKC,QAAL,CAAckB,OAAd,CAAsB,KAAKpB,uBAA3B,KAAuD,KAAKW,IAAL,CAAUU,WAAxE;AACD;;;;kBA3DkBpC,U","file":"index.js","sourcesContent":["import mask from 'json-mask';\nimport { Module } from '../../lib/di';\nimport DataFetcher from '../../lib/DataFetcher';\nimport createSimpleReducer from '../../lib/createSimpleReducer';\nimport actionTypes from './actionTypes';\nimport proxify from '../../lib/proxy/proxify';\n\nconst DEFAULT_MASK = 'phoneNumber,hostCode,participantCode,phoneNumbers(country,phoneNumber),allowJoinBeforeHost';\n\n/**\n * @class\n * @description Conference managing module\n */\n@Module({\n  deps: [\n    'Client', 'Storage', 'RegionSettings', { dep: 'ConferenceOptions', optional: true }\n  ]\n})\nexport default class Conference extends DataFetcher {\n  /**\n   * @constructor\n   * @param {Object} params - params object\n   * @param {RegionSettings} params.regionSettings - regionSettings module instance\n   * @param {Client} params.client - client module instance\n   */\n  constructor({\n    client,\n    regionSettings,\n    storage,\n    ...options\n  }) {\n    super({\n      name: 'conference',\n      client,\n      fetchFunction: async () => mask(\n        await client.account().extension().conferencing().get(),\n        DEFAULT_MASK,\n      ),\n      actionTypes,\n      storage,\n      ...options,\n    });\n    this._dialInNumberStorageKey = 'conferenceDialInNumber';\n    this._additionalNumbersStorageKey = 'conferenceAdditionalNumbers';\n    this._storage.registerReducer({\n      key: this._dialInNumberStorageKey,\n      reducer: createSimpleReducer(this.actionTypes.updateDialInNumber, 'dialInNumber'),\n    });\n    this._storage.registerReducer({\n      key: this._additionalNumbersStorageKey,\n      reducer: createSimpleReducer(this.actionTypes.updateAdditionalNumbers, 'additionalNumbers'),\n    });\n  }\n\n  @proxify\n  async updateEnableJoinBeforeHost(allowJoinBeforeHost) {\n    const data = await this._client.account().extension().conferencing()\n      .put({ allowJoinBeforeHost });\n    this._store.dispatch({ type: this.actionTypes.fetchSuccess, data });\n  }\n\n  @proxify\n  updateDialInNumber(dialInNumber) {\n    this._store.dispatch({ type: this.actionTypes.updateDialInNumber, dialInNumber });\n  }\n\n  @proxify\n  updateAdditionalNumbers(additionalNumbers) {\n    this._store.dispatch({ type: this.actionTypes.updateAdditionalNumbers, additionalNumbers });\n  }\n\n  get additionalNumbers() {\n    return this._storage.getItem(this._additionalNumbersStorageKey) || [];\n  }\n\n  get dialInNumber() {\n    return this._storage.getItem(this._dialInNumberStorageKey) || this.data.phoneNumber;\n  }\n\n  _shouldFetch() {\n    return !this._tabManager || this._tabManager.active;\n  }\n}\n"]}