{"version":3,"sources":["modules/webphone/call-reducer.js"],"names":["state","action","initialState","type","error","clear","record","status","contain","recording","concat","stopRecord","remove","mute","muted","unmute","hold","holding","disabled","unhold","park","parker","transfer","transfered","transferTaget","payload","number","flip","flipTarget","dtmf","parked","dtmfNumber","arr","ele","indexOf","splice"],"mappings":"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","file":"call-reducer.js","sourcesContent":["import callActions from './call-actions';\nimport callStatus from './call-status';\n\nfunction contain(arr, ele) {\n  return arr.indexOf(ele) > -1;\n}\n\nfunction remove(arr, ele) {\n  if (contain(arr, ele)) {\n    arr.splice(arr.indexOf(ele), 1);\n  }\n  return arr;\n}\n\nconst initialState = {\n  // operations which is enable\n  status: [],\n  // some operations will disable another, such as 'hold'\n  disabled: [],\n  // some operations have infomation need to be stored\n  transferTaget: null,\n  flipTarget: null,\n  dtmfNumber: null,\n  // operation error\n  error: null,\n};\n\nexport default function (state, action) {\n  if (typeof state === 'undefined') return Object.assign({}, initialState);\n  if (!action) return state;\n  switch (action.type) {\n\n    case callActions.error:\n      return Object.assign({}, state, {\n        error: action.error,\n      });\n    case callActions.clear:\n      return Object.assign({}, initialState);\n    case callActions.record:\n      return Object.assign({}, state, {\n        status: contain(state.status, callStatus.recording) ?\n                  state.status :\n                  state.status.concat(callStatus.recording),\n      });\n    case callActions.stopRecord:\n      return Object.assign({}, state, {\n        status: remove(state.status, callStatus.recording),\n      });\n    case callActions.mute:\n      return Object.assign({}, state, {\n        status: contain(state.status, callStatus.muted) ?\n                  state.status :\n                  state.status.concat(callStatus.muted),\n      });\n    case callActions.unmute:\n      return Object.assign({}, state, {\n        status: remove(state.status, callStatus.muted),\n      });\n    case callActions.hold:\n      return Object.assign({}, state, {\n        status: contain(state.status, callStatus.holding) ?\n                  state.status :\n                  state.status.concat(callStatus.holding),\n        disabled: ['park', 'record'],\n      });\n    case callActions.unhold:\n      return Object.assign({}, state, {\n        status: remove(state.status, callStatus.holding),\n        disabled: [],\n      });\n    case callActions.park:\n      // https://en.wikipedia.org/wiki/Call_parking\n      return Object.assign({}, state, {\n        status: contain(state.status, callStatus.parker) ?\n                  state.status :\n                  state.status.concat(callStatus.parker),\n      });\n    case callActions.transfer:\n      return Object.assign({}, state, {\n        status: contain(state.status, callStatus.transfered) ?\n                  state.status :\n                  state.status.concat(callStatus.transfered),\n        transferTaget: action.payload.number,\n      });\n    case callActions.flip:\n      return Object.assign({}, state, {\n        status: contain(state.status, callStatus.flip) ?\n                  state.status :\n                  state.status.concat(callStatus.flip),\n        flipTarget: action.payload.number,\n      });\n    case callActions.dtmf:\n      // TODO: clarify park action\n      return Object.assign({}, state, {\n        status: state.status.concat(callStatus.parked),\n        dtmfNumber: action.payload.number,\n      });\n\n    default:\n      return state;\n  }\n}\n"]}