{"version":3,"sources":["modules/contact/address-book/index.js"],"names":["symbols","AddressBook","options","actions","api","platform","settings","on","events","loginSuccess","loadCompanyContact","loggedIn","loadAddressBook","userOptions","perPage","store","dispatch","type","account","extension","addressBook","contact","get","book","loadAddressBookSuccess","payload","console","error","loadAddressBookFailed","prefix"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AAEA,IAAMA,UAAU,wBAAc,CAC5B,KAD4B,EAE5B,UAF4B,EAG5B,UAH4B,CAAd,CAAhB;;AAMA;;;;;IAIqBC,W;;;AACnB;;;AAGA,uBAAYC,OAAZ,EAAqB;AAAA;;AAAA;;AAAA,2KAEdA,OAFc;AAGjBC;AAHiB;;AAAA,QAMjBC,GANiB,GASfF,OATe,CAMjBE,GANiB;AAAA,QAOjBC,QAPiB,GASfH,OATe,CAOjBG,QAPiB;AAAA,QAQjBC,QARiB,GASfJ,OATe,CAQjBI,QARiB;;AAUnB,UAAKN,QAAQI,GAAb,IAAoBA,GAApB;AACA,UAAKJ,QAAQK,QAAb,IAAyBA,QAAzB;AACA,UAAKL,QAAQM,QAAb,IAAyBA,QAAzB;;AAEAD,aAASE,EAAT,CAAYF,SAASG,MAAT,CAAgBC,YAA5B,EAA0C,YAAM;AAC9C,YAAKC,kBAAL;AACD,KAFD;;AAIA,+DAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACWL,SAASM,QAAT,EADX;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAES,MAAKC,eAAL,EAFT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD;AAlBmB;AAuBpB;;;;;;;;wFAKG,E;;sCAFFC,W;YAAAA,W,qCAAc,E;kCACdC,O;YAAAA,O,iCAAU,K;;;;;;AAEV,qBAAKC,KAAL,CAAWC,QAAX,CAAoB;AAClBC,wBAAM,KAAKd,OAAL,CAAaS;AADD,iBAApB;;;uBAIiC,4BAAgB;AAAA,yBAC7C,OAAKZ,QAAQI,GAAb,EAAkBc,OAAlB,GAA4BC,SAA5B,GAAwCC,WAAxC,GAAsDC,OAAtD,GAAgEC,GAAhE,4BACKpB,OADL,EAEKW,WAFL;AAGEC;AAHF,qBAD6C;AAAA,iBAAhB,C;;;;AAAzBS,oB;;AAON,qBAAKR,KAAL,CAAWC,QAAX,CAAoB;AAClBC,wBAAM,KAAKd,OAAL,CAAaqB,sBADD;AAElBC,2BAASF;AAFS,iBAApB;;;;;;;;AAKAG,wBAAQC,KAAR;AACA,qBAAKZ,KAAL,CAAWC,QAAX,CAAoB;AAClBC,wBAAM,KAAKd,OAAL,CAAayB,qBADD;AAElBD;AAFkB,iBAApB;;;;;;;;;;;;;;;;;;wBAOU;AACZ,aAAO,kCAAQ,KAAKE,MAAb,CAAP;AACD;;;;;kBA3DkB5B,W","file":"index.js","sourcesContent":["import RcModule from '../../../lib/rc-module';\nimport SymbolMap from 'data-types/symbol-map';\nimport KeyValueMap from 'data-types/key-value-map';\nimport reducer from './address-book-reducer';\nimport actions from './address-book-actions';\n\nimport { fetchList, extractData } from '../../../lib/utils';\n\nconst symbols = new SymbolMap([\n  'api',\n  'platform',\n  'settings',\n]);\n\n/**\n * @class\n * @description Contact module\n */\nexport default class AddressBook extends RcModule {\n  /**\n   * @function\n   */\n  constructor(options) {\n    super({\n      ...options,\n      actions,\n    });\n    const {\n      api,\n      platform,\n      settings,\n    } = options;\n    this[symbols.api] = api;\n    this[symbols.platform] = platform;\n    this[symbols.settings] = settings;\n\n    platform.on(platform.events.loginSuccess, () => {\n      this.loadCompanyContact();\n    });\n\n    (async () => {\n      if (await platform.loggedIn()) {\n        await this.loadAddressBook();\n      }\n    })();\n  }\n\n  async loadAddressBook({\n    userOptions = {},\n    perPage = 'max',\n  } = {}) {\n    this.store.dispatch({\n      type: this.actions.loadAddressBook,\n    });\n    try {\n      const book = extractData(await this::fetchList(options => (\n        this[symbols.api].account().extension().addressBook().contact().get({\n          ...options,\n          ...userOptions,\n          perPage,\n        })\n      )));\n      this.store.dispatch({\n        type: this.actions.loadAddressBookSuccess,\n        payload: book,\n      });\n    } catch (error) {\n      console.error(error);\n      this.store.dispatch({\n        type: this.actions.loadAddressBookFailed,\n        error,\n      });\n    }\n  }\n\n  get reducer() {\n    return reducer(this.prefix);\n  }\n}\n"]}